% RNA interference modeled by Deterministic ODE
% Author: Baihan Lin
% Date: Nov 2016

clear all; close all

ep1 = p(1);
ep2 = p(2);
H1 = p(3);
H2 = p(4);
H3 = p(5);

for numreps=1:1

p = [0.0737 1.29 0.0411 0.0212 0.23 0.101 0.23];
x0 = [0, 0, 0, 0];

Tmax=80;
options = odeset('NonNegative',1:4); %make solutions nonnegative

[T,Y] = ode45(@(t,y) iRNA_ODE(t,y,p),[0 Tmax],x0,options);


%plot phosphorylated vs non-phosphorylated
figure(1)
set(gca,'FontSize',16)
subplot(2,1,1)
plot(T,Y(:,3:4),'LineWidth',3); hold on;
plot(T,Y(:,6),'LineWidth',3); hold on;
legend('v (iRNA)','r ()','q')
xlabel('t'); 
ylabel('%');

end